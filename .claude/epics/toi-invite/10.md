---
name: Guest Invitation Page
status: open
created: 2026-02-20T15:25:54Z
updated: 2026-02-20T15:48:31Z
github: https://github.com/Temirlaaan/toi-invite/issues/10
depends_on: [8]
parallel: true
conflicts_with: []
---

# Task: Guest Invitation Page

## Description
Build the public-facing, server-rendered invitation page that guests see when they open a shared link. Mobile-first design with all template sections rendered dynamically from event customization data.

## Acceptance Criteria
- [ ] Event page at `/[locale]/e/[slug]` (public, no auth)
- [ ] Personalized guest page at `/[locale]/e/[slug]/g/[token]` with guest name pre-filled
- [ ] Template sections rendered dynamically: hero, event details, countdown, photo gallery, map, RSVP form, Kaspi QR gift
- [ ] Countdown timer (client component) showing days/hours/minutes to event
- [ ] Photo/video gallery with lightbox
- [ ] Background music player (auto-play with user interaction, play/pause toggle)
- [ ] Venue section with embedded map preview and "Open in 2GIS" / "Open in Yandex Maps" buttons
- [ ] Kaspi QR section displaying organizer's QR code image with "Send Gift" label
- [ ] Dynamic Open Graph meta tags (title, description, event image) for rich link previews in WhatsApp/Telegram
- [ ] Server-rendered (SSR) for performance and SEO
- [ ] Mobile-first responsive design — works beautifully on phones
- [ ] Page loads in < 3 seconds (optimized images via next/image, lazy loading)
- [ ] Guest view tracking: increment viewCount and lastViewedAt on personalized link visits
- [ ] Language switcher (kk/ru) on invitation page

## Technical Details
- Server component fetches event + template data, renders section components
- Each template section is a React component that receives config + customization data
- Map links use deep links: `dgis://2gis.ru/routeSearch/...` and `yandexmaps://...` with web fallbacks
- OG tags via `generateMetadata` in the page's layout/page file
- Guest view tracking via middleware or server action on page load (for token-based links)
- Background music: `<audio>` element with custom play/pause UI, respects autoplay policies
- Images served from MinIO via next/image with custom loader

## Dependencies
- [ ] Task 8: Event builder creates the data this page renders
- [ ] Task 6: Template config format defines section structure

## Effort Estimate
- Size: L
- Hours: 16
- Parallel: true — can be worked on alongside Task 3 and 5 once Task 8 is done
